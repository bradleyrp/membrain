(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     81773,       2187]
NotebookOptionsPosition[     80308,       2134]
NotebookOutlinePosition[     80644,       2149]
CellTagsIndexPosition[     80601,       2146]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
  "SetDirectory", "[", "\"\<~/worker/membrain/framefilter/\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Needs", "[", "\"\<PlotLegends`\>\"", "]"}]}], "Input",
 CellChangeTimes->{{3.56371892833074*^9, 3.5637189310718737`*^9}, {
  3.5637550303727818`*^9, 3.5637550352444687`*^9}, {3.5637552431862173`*^9, 
  3.5637552517427483`*^9}, {3.563757416468583*^9, 3.563757435955715*^9}, {
  3.563821996469136*^9, 3.5638219989170523`*^9}, {3.563840907165079*^9, 
  3.563840916982841*^9}, {3.5638786146676207`*^9, 3.5638786153726187`*^9}, {
  3.5912848443072433`*^9, 3.591284856117629*^9}, {3.591284923917285*^9, 
  3.5912849270221987`*^9}, {3.591284963255742*^9, 3.591284965979327*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"heightscale", "=", "2.5"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"rot", "[", "th_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Cos", "[", "th", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "th", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sin", "[", "th", "]"}], ",", 
      RowBox[{"Cos", "[", "th", "]"}]}], "}"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"fx", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", "hpp"}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "-", "xcpp"}], ")"}], "^", "2"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "w1pp"}], ")"}]}], "]"}], "*", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "-", "ycpp"}], ")"}], "^", "2"}]}], "/", 
     RowBox[{"(", 
      RowBox[{"2", "w2pp"}], ")"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.591285790000608*^9, 3.591285794506939*^9}, {
  3.591285941274954*^9, 3.591285941905944*^9}, {3.59144354654247*^9, 
  3.591443546733993*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"fxfluid", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "hpp"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "xcpp"}], ")"}], "*", 
           RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "ycpp"}], ")"}], "*", 
           RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "^", "2"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "w1pp"}], ")"}]}], "]"}], "*", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"x", "-", "xcpp"}], ")"}]}], 
           RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"y", "-", "ycpp"}], ")"}], 
           RowBox[{"Cos", "[", "t", "]"}]}]}], ")"}], "^", "2"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"2", "w2pp"}], ")"}]}], "]"}]}], "+", "zshift"}]}]], "Input",
 CellChangeTimes->{{3.591285795763443*^9, 3.591285806883253*^9}, {
  3.591285944730812*^9, 3.591286035918083*^9}, {3.5912860659666843`*^9, 
  3.5912860921927*^9}, {3.591443547955927*^9, 3.591443548516892*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"curvfx", "[", 
   RowBox[{"x_", ",", "y_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"fx", "[", 
            RowBox[{"x", ",", "y"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "1"}], "}"}]}], "]"}], "^", "2"}]}], ")"}], 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{"fx", "[", 
            RowBox[{"x", ",", "y"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "1"}], "}"}]}], "]"}], "^", "2"}]}], ")"}], 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "-", 
     RowBox[{"2", "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}]}], "]"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"fx", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"y", ",", "1"}], "}"}]}], "]"}]}]}], ")"}], "/", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"fx", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "1"}], "}"}]}], "]"}], ")"}], "^", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"fx", "[", 
           RowBox[{"x", ",", "y"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", "1"}], "}"}]}], "]"}], ")"}], "^", "2"}]}], 
     ")"}], "^", 
    RowBox[{"(", 
     RowBox[{"3", "/", "2"}], ")"}]}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"curvfx", "[", 
  RowBox[{"x", ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.591293720080123*^9, 3.5912937250620403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
             RowBox[{"Cos", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w2pp"]}], "-", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
            RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
            RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w1pp"]}]], " ", 
     SuperscriptBox["hpp", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "t1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
            RowBox[{"Cos", "[", "t", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
            RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"Cos", "[", "t1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
            RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
            RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], ")"}], 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", "t", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
             RowBox[{"Cos", "[", "t", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"Sin", "[", "t1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
            RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
            RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], ")"}], 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                 RowBox[{"Cos", "[", "t", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                 RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
             RowBox[{"2", " ", "w2pp"}]]}], "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
            RowBox[{"2", " ", "w1pp"}]]}]]}], " ", "hpp", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"Cos", "[", "t", "]"}], " ", 
            RowBox[{"Sin", "[", "t1", "]"}]}], "w2pp"], "-", 
          FractionBox[
           RowBox[{
            RowBox[{"Cos", "[", "t1", "]"}], " ", 
            RowBox[{"Sin", "[", "t1", "]"}]}], "w1pp"]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
            RowBox[{"2", " ", "w2pp"}]]}], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
           RowBox[{"2", " ", "w1pp"}]]}]], " ", "hpp", " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            RowBox[{"Sin", "[", "t1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"], "-", 
          FractionBox[
           RowBox[{
            RowBox[{"Cos", "[", "t1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], ")"}],
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", "t", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"]}], "-", 
          
          FractionBox[
           RowBox[{
            RowBox[{"Sin", "[", "t1", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{"hpp", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w2pp"]}], 
          "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w1pp"]}]], 
        " ", 
        SuperscriptBox["hpp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"Sin", "[", "t1", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", "t1", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], 
          ")"}], "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                 RowBox[{"Cos", "[", "t", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                 RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
             RowBox[{"2", " ", "w2pp"}]]}], "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
            RowBox[{"2", " ", "w1pp"}]]}]]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "t", "]"}], "2"], "w2pp"]}], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Sin", "[", "t1", "]"}], "2"], "w1pp"]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
            RowBox[{"2", " ", "w2pp"}]]}], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
           RowBox[{"2", " ", "w1pp"}]]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"Cos", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                 RowBox[{"Cos", "[", "t", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                 RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"]}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"Sin", "[", "t1", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], 
          ")"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"hpp", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                 RowBox[{"Cos", "[", "t", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                 RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
             RowBox[{"2", " ", "w2pp"}]]}], "-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
            RowBox[{"2", " ", "w1pp"}]]}]]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"Cos", "[", "t1", "]"}], "2"], "w1pp"]}], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"Sin", "[", "t1", "]"}], "2"], "w2pp"]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
            RowBox[{"2", " ", "w2pp"}]]}], "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], 
           RowBox[{"2", " ", "w1pp"}]]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"Sin", "[", "t1", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"Cos", "[", "t1", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], 
          ")"}], "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w2pp"]}], 
          "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w1pp"]}]], 
        " ", 
        SuperscriptBox["hpp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"Cos", "[", "t", "]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                 RowBox[{"Cos", "[", "t", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
                 RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"]}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"Sin", "[", "t1", "]"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
                RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
                RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], 
          ")"}], "2"]}]}], ")"}]}]}], ")"}], "/", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
              RowBox[{"Cos", "[", "t", "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
              RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w2pp"]}], 
        "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
             RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w1pp"]}]], 
      " ", 
      SuperscriptBox["hpp", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"Sin", "[", "t1", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
              RowBox[{"Cos", "[", "t", "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
              RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Cos", "[", "t1", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
              RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
              RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], ")"}], 
       "2"]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
              RowBox[{"Cos", "[", "t", "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
              RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w2pp"]}], 
        "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
             RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
             RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "2"], "w1pp"]}]], 
      " ", 
      SuperscriptBox["hpp", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"Cos", "[", "t", "]"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
               RowBox[{"Cos", "[", "t", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "x"}], "+", "xcpp"}], ")"}], " ", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w2pp"]}], "-", 
         FractionBox[
          RowBox[{
           RowBox[{"Sin", "[", "t1", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xcpp"}], ")"}], " ", 
              RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y", "-", "ycpp"}], ")"}], " ", 
              RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}]}], "w1pp"]}], ")"}], 
       "2"]}]}], ")"}], 
   RowBox[{"3", "/", "2"}]]}]], "Output",
 CellChangeTimes->{3.591293726566485*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dynamic", "[", "frameno", "]"}], "\n", 
 RowBox[{
  RowBox[{"curves", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"domains", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"regions", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"maps", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"cplotzs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"curves2", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"means", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dats", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "a", ",", "b", ",", "c", ",", "ap", ",", "bp", ",", "cp", ",", "w1p", ",", 
    "w2p", ",", "hp", ",", "xcp", ",", "ycp", ",", "w1", ",", "w2", ",", "h", 
    ",", "xc", ",", "yc", ",", "zshift", ",", "t1"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"frameno", "=", "1"}], ",", 
    RowBox[{"frameno", "\[LessEqual]", "1"}], ",", 
    RowBox[{"frameno", "++"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "ap", ",", "bp", ",", "cp", ",", "w1p", 
        ",", "w2p", ",", "hp", ",", "xcp", ",", "ycp", ",", "w1", ",", "w2", 
        ",", "h", ",", "xc", ",", "yc", ",", "zshift", ",", "t1"}], "]"}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"filename", "=", 
       RowBox[{"\"\<framefilter.\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"NumberForm", "[", 
          RowBox[{"frameno", ",", 
           RowBox[{"{", 
            RowBox[{"4", ",", "0"}], "}"}], ",", 
           RowBox[{"NumberPadding", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\"\<0\>\"", ",", "\"\<\>\""}], "}"}]}]}], "]"}], "]"}], 
        "<>", "\"\<dat\>\""}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"file", "=", 
       RowBox[{"OpenRead", "[", "filename", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"rawfile", "=", 
       RowBox[{"ReadList", "[", 
        RowBox[{"file", ",", 
         RowBox[{"{", 
          RowBox[{"Number", ",", "Number", ",", "Number"}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"Close", "[", "file", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", "=", "rawfile"}], ";", "\[IndentingNewLine]", 
      RowBox[{"datar", "=", "data"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"datac", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "data", "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
              RowBox[{"Mean", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "data", "]"}], "[", 
                RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ",", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"means", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Mean", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "data", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
            RowBox[{"Mean", "[", 
             RowBox[{
              RowBox[{"Transpose", "[", "data", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"normal", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "1"}], "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"normalo", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}], ",", 
           RowBox[{"1", "/", 
            RowBox[{"Sqrt", "[", "2", "]"}]}], ",", "0"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"proj3", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", "normal"}], ")"}], "*", 
             "normal"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"proj2", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"proj3", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"proj3", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"proj3o", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"data", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"data", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", "normalo"}], ")"}], "*", 
             "normalo"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"proj2o", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"proj3o", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"proj3o", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"ap", ",", "bp", ",", "cp"}], "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}], "/.", 
          RowBox[{"FindFit", "[", 
           RowBox[{"proj2", ",", 
            RowBox[{"{", 
             RowBox[{"a", "+", 
              RowBox[{"b", "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "c"}], ")"}], "^", "2"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "b", ",", "c"}], "}"}], ",", "x"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "/", "bp"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pl1", "=", 
         RowBox[{"ListPlot", "[", "proj2", "]"}]}], ";"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"pl2", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"ap", "+", 
            RowBox[{"bp", "*", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "cp"}], ")"}], "^", "2"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Min", "[", "proj2", "]"}], ",", 
             RowBox[{"Max", "[", "proj2", "]"}]}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Black", ",", "Thick"}], "}"}], "}"}]}]}], "]"}]}], 
        ";"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"regionplot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"Transpose", "[", "data", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"Transpose", "[", "data", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "}"}], "]"}], ",", 
           RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "70"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "70"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"PointSize", "[", "0.01", "]"}], "}"}]}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"datar", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"rot", "[", "0", "]"}], ".", 
              RowBox[{"datac", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", 
                 RowBox[{"1", ";;", "2"}]}], "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"datac", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "3"}], "]"}], "]"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "datac", "]"}]}], "}"}]}], "]"}]}], ";"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"dats", ",", "datar"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"shifter", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "data", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
           RowBox[{"Mean", "[", 
            RowBox[{
             RowBox[{"Transpose", "[", "data", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"regplot", "=", 
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"datar", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
                RowBox[{"datar", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "}"}], "+", 
              "shifter"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", 
               RowBox[{"Length", "[", "datar", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"PointSize", "[", "0.006", "]"}], ",", "Gray"}], "}"}],
              "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"plt3d1", "=", 
           RowBox[{"ListPointPlot3D", "[", 
            RowBox[{"datar", ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"PointSize", "[", "0.01", "]"}], "}"}]}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "500"}], ",", 
             RowBox[{"BoxRatios", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"3", ",", "1", ",", "1"}], "}"}]}]}], "]"}]}], ";"}], 
         "*)"}], 
        RowBox[{"lims", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "}"}]}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w1p", ",", "w2p", ",", "hp", ",", "xcp", ",", "ycp"}], 
          "}"}], "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"w1", ",", "w2", ",", "h", ",", "xc", ",", "yc"}], "}"}], "/.", 
          RowBox[{"FindFit", "[", 
           RowBox[{"datar", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "h"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x", "-", "xc"}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "w1"}], ")"}]}], "]"}], "*", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"y", "-", "yc"}], ")"}], "^", "2"}]}], "/", 
                 RowBox[{"(", 
                  RowBox[{"2", "w2"}], ")"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"xc", "\[LessEqual]", 
                 RowBox[{"lims", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
                RowBox[{"xc", "\[GreaterEqual]", 
                 RowBox[{"lims", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}]}], "}"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"w1", ",", "w2", ",", "h", ",", "xc", ",", "yc"}], "}"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], ",", 
            RowBox[{"MaxIterations", "\[Rule]", "100"}]}], "]"}]}]}], ";"}], 
       "*)"}], 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "w1p", ",", "w2p", ",", "hp", ",", "xcp", ",", "ycp", ",", "t1p", ",",
          "zshiftp"}], "}"}], "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "w1", ",", "w2", ",", "h", ",", "xc", ",", "yc", ",", "t1", ",", 
          "zshift"}], "}"}], "/.", 
        RowBox[{"FindFit", "[", 
         RowBox[{"data", ",", 
          RowBox[{"{", 
           RowBox[{"zshift", "+", 
            RowBox[{
             RowBox[{"-", "h"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"x", "-", "xc"}], ")"}], "*", 
                    RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "yc"}], ")"}], "*", 
                    RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "^", "2"}]}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"2", "w1"}], ")"}]}], "]"}], "*", 
             RowBox[{"Exp", "[", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"x", "-", "xc"}], ")"}]}], 
                    RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"y", "-", "yc"}], ")"}], 
                    RowBox[{"Cos", "[", "t1", "]"}]}]}], ")"}], "^", "2"}]}], 
               "/", 
               RowBox[{"(", 
                RowBox[{"2", "w2"}], ")"}]}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "w1", ",", "w2", ",", "h", ",", "xc", ",", "yc", ",", "zshift", 
            ",", "t1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y"}], "}"}], ",", 
          RowBox[{"MaxIterations", "\[Rule]", "500"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"plt3d2", "=", 
         RowBox[{"Plot3D", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "hp"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcp"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "w1p"}], ")"}]}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycp"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "w2p"}], ")"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}], "*)"}], 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"plt3d2", "=", 
         RowBox[{"ContourPlot", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "hp"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"x", "-", "xcp"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "w1p"}], ")"}]}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"y", "-", "ycp"}], ")"}], "^", "2"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"2", "w2p"}], ")"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"Min", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Max", "[", 
              RowBox[{
               RowBox[{"Transpose", "[", "datar", "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}], "*)"}], 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Show", "[", 
         RowBox[{"plt3d1", ",", "plt3d2", ",", 
          RowBox[{"BoxRatios", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"2", ",", "1", ",", "1"}], "}"}]}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "800"}]}], "]"}], ";"}], "*)"}], 
      RowBox[{
       RowBox[{"curvfx2", "[", 
        RowBox[{"x_", ",", "y_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"curvfx", "[", 
         RowBox[{"x", ",", "y"}], "]"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"hpp", "\[Rule]", "hp"}], ",", 
          RowBox[{"xcpp", "\[Rule]", "xcp"}], ",", 
          RowBox[{"ycpp", "\[Rule]", "ycp"}], ",", 
          RowBox[{"w1pp", "\[Rule]", "w1p"}], ",", 
          RowBox[{"w2pp", "\[Rule]", "w2p"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"plt3d3", "=", 
         RowBox[{"ContourPlot", "[", 
          RowBox[{
           RowBox[{"curvfx2", "[", 
            RowBox[{"x", ",", "y"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"xcp", "-", "50"}], ",", 
             RowBox[{"xcp", "+", "50"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"ycp", "-", "50"}], ",", 
             RowBox[{"ycp", "+", "50"}]}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}], "*)"}], 
      
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"cplot", "=", 
         RowBox[{"ContourPlot", "[", 
          RowBox[{
           RowBox[{"curvfx2", "[", 
            RowBox[{
             RowBox[{"x", "-", 
              RowBox[{"shifter", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"y", "-", 
              RowBox[{"shifter", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"lims", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "+", 
              RowBox[{"shifter", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"lims", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "2"}], "]"}], "]"}]}], "+", 
              RowBox[{"shifter", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"lims", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "+", 
              RowBox[{"shifter", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"3", 
               RowBox[{"lims", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "+", 
              RowBox[{"shifter", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";"}], "*)"}], 
      
      RowBox[{"cplot", "=", 
       RowBox[{"ContourPlot", "[", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"curvfx2", "[", 
           RowBox[{
            RowBox[{"x", "-", 
             RowBox[{"shifter", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"y", "-", 
             RowBox[{"shifter", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "50"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "50"}], ",", "100"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.02"}], ",", "0.02"}], "}"}]}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}], ",", 
         
         RowBox[{"Contours", "\[Rule]", "20"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"cplotz", "=", 
       RowBox[{"ContourPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hp"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"x", "-", "xcp", "-", 
                RowBox[{"shifter", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}]}], "/", 
            RowBox[{"(", 
             RowBox[{"2", " ", "w1p"}], ")"}]}], "]"}], "*", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"y", "-", "ycp", "-", 
                RowBox[{"shifter", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}]}], "/", 
            RowBox[{"(", 
             RowBox[{"2", " ", "w2p"}], ")"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"-", "50"}], ",", "100"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "50"}], ",", "100"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ",", 
         RowBox[{"Contours", "\[Rule]", "20"}], ",", 
         RowBox[{"ColorFunction", "\[Rule]", "\"\<TemperatureMap\>\""}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Show", "[", 
        RowBox[{"plt3d1", ",", "plt3d2", ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "*)"}], 
      RowBox[{"AppendTo", "[", 
       RowBox[{"curves", ",", 
        RowBox[{
         RowBox[{"curvfx", "[", 
          RowBox[{"m", ",", "n"}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"m", "\[Rule]", "xcp"}], ",", 
           RowBox[{"n", "\[Rule]", "ycp"}], ",", 
           RowBox[{"hpp", "\[Rule]", "hp"}], ",", 
           RowBox[{"xcpp", "\[Rule]", "xcp"}], ",", 
           RowBox[{"ycpp", "\[Rule]", "ycp"}], ",", 
           RowBox[{"w1pp", "\[Rule]", "w1p"}], ",", 
           RowBox[{"w2pp", "\[Rule]", "w2p"}]}], "}"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"curves2", ",", 
        RowBox[{"Max", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"curvfx2", "[", 
            RowBox[{
             RowBox[{"datar", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"datar", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "2"}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "datar", "]"}]}], "}"}]}], "]"}], "]"}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"domains", ",", "cplot"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"regions", ",", "regplot"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"cplotzs", ",", 
        RowBox[{"Show", "[", 
         RowBox[{"cplotz", ",", "regplot"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"maps", ",", 
        RowBox[{"Show", "[", 
         RowBox[{"cplot", ",", "regplot"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"params", ",", 
        RowBox[{"{", 
         RowBox[{"w1p", ",", "w2p", ",", "hp", ",", "xcp", ",", "ycp"}], 
         "}"}]}], "]"}], ";"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.5641073228263474`*^9, 3.5641073228268757`*^9}, {
   3.564145165380185*^9, 3.564145168931903*^9}, {3.591284981456917*^9, 
   3.591284981973648*^9}, {3.59128610867782*^9, 3.591286126598136*^9}, {
   3.591286309760108*^9, 3.591286373950335*^9}, {3.5912864427126293`*^9, 
   3.591286459813477*^9}, {3.591286497042017*^9, 3.5912865121287127`*^9}, {
   3.5912865563945312`*^9, 3.5912865723326893`*^9}, 3.5912866106607723`*^9, {
   3.591286700543934*^9, 3.59128678823706*^9}}],

Cell[BoxData[
 DynamicBox[ToBoxes[$CellContext`frameno, StandardForm],
  ImageSizeCache->{56., {0., 8.}}]], "Output",
 CellChangeTimes->{{3.591286514281106*^9, 3.591286542630632*^9}, 
   3.5912865732107487`*^9, 3.5912866121611223`*^9, 3.591286677079818*^9, {
   3.591286737995579*^9, 3.591286803596242*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t1", "=", "0"}]], "Input",
 CellChangeTimes->{{3.591286840821773*^9, 3.591286850589439*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.5912868510348377`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"w1p", ",", "w2p", ",", "hp", ",", "xcp", ",", "ycp"}], "}"}], 
   "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"w1", ",", "w2", ",", "h", ",", "xc", ",", "yc"}], "}"}], "/.", 
    RowBox[{"FindFit", "[", 
     RowBox[{"data", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "h"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"x", "-", "xc"}], ")"}], "*", 
               RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "yc"}], ")"}], "*", 
               RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "^", "2"}]}], "/", 
          
          RowBox[{"(", 
           RowBox[{"2", "w1"}], ")"}]}], "]"}], "*", 
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{"x", "-", "xc"}], ")"}]}], 
               RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"y", "-", "yc"}], ")"}], 
               RowBox[{"Cos", "[", "t1", "]"}]}]}], ")"}], "^", "2"}]}], "/", 
          
          RowBox[{"(", 
           RowBox[{"2", "w2"}], ")"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"w1", ",", "w2", ",", "h", ",", "xc", ",", "yc"}], "}"}], ",", 
      
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}], ",", 
      RowBox[{"MaxIterations", "\[Rule]", "500"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.591286828774909*^9, 3.591286863177904*^9}}],

Cell[CellGroupData[{

Cell[BoxData["w1p"], "Input",
 CellChangeTimes->{{3.591286865676983*^9, 3.5912868670026903`*^9}}],

Cell[BoxData["1.`"], "Output",
 CellChangeTimes->{3.591286867207561*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FindFit", "[", 
  RowBox[{"data", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.860499080853714"}], "+", 
     RowBox[{
      RowBox[{"-", "h"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"x", "-", "xc"}], ")"}], "*", 
             RowBox[{"Cos", "[", "t1", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "yc"}], ")"}], "*", 
             RowBox[{"Sin", "[", "t1", "]"}]}]}], ")"}], "^", "2"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "w1"}], ")"}]}], "]"}], "*", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{"x", "-", "xc"}], ")"}]}], 
             RowBox[{"Sin", "[", "t1", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"y", "-", "yc"}], ")"}], 
             RowBox[{"Cos", "[", "t1", "]"}]}]}], ")"}], "^", "2"}]}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "w2"}], ")"}]}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"w1", ",", "w2", ",", "h", ",", "xc", ",", "yc"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}], ",", 
   RowBox[{"MaxIterations", "\[Rule]", "500"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.591286908512136*^9, 3.591286909808764*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"w1", "\[Rule]", "1.`"}], ",", 
   RowBox[{"w2", "\[Rule]", "1.`"}], ",", 
   RowBox[{"h", "\[Rule]", "1.`"}], ",", 
   RowBox[{"xc", "\[Rule]", "1.`"}], ",", 
   RowBox[{"yc", "\[Rule]", "1.`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.591286874228745*^9, {3.591286910494368*^9, 3.5912869143643*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPointPlot3D", "[", "data", "]"}]], "Input",
 CellChangeTimes->{{3.591286924810854*^9, 3.5912869781446238`*^9}}],

Cell[BoxData[
 Graphics3DBox[
  {Hue[0.67, 0.6, 0.6], 
   Point3DBox[{{6, 12, 1.58588673301}, {6, 13, -3.51902534777}, {
     6, 14, -8.86828809192}, {6, 15, -7.1708891552}, {
     6, 16, -6.10693451458}, {6, 17, -0.833960985147}, {
     6, 18, -0.72914492194}, {6, 19, -1.52215914759}, {
     6, 20, -1.65753627246}, {6, 21, -2.49301083929}, {
     6, 22, -3.98259234113}, {6, 23, -2.65056593009}, {
     7, 12, 1.91087780572}, {7, 13, -1.89106248378}, {
     7, 14, -7.09961581104}, {7, 15, -7.56956433346}, {
     7, 16, -7.52601279604}, {7, 17, -5.53668350724}, {
     7, 18, -6.54595679836}, {7, 19, -4.41264548743}, {
     7, 20, -7.39599630625}, {7, 21, -5.33820101325}, {
     7, 22, -7.30340373339}, {7, 23, -8.58301044996}, {
     8, 12, 7.60842686522}, {8, 13, -1.01723376817}, {
     8, 14, -4.40726097647}, {8, 15, -4.30736192875}, {
     8, 16, -5.44724688172}, {8, 17, -8.54630378518}, {
     8, 18, -8.50178559296}, {8, 19, -7.55817046051}, {
     8, 20, -9.20967737629}, {8, 21, -7.84245164462}, {
     8, 22, -7.80574982965}, {8, 23, -7.01682897596}, {
     9, 12, 5.72543864539}, {9, 13, 0.506830090611}, {
     9, 14, -3.33154577745}, {9, 15, -3.55335510291}, {
     9, 16, -4.22842553275}, {9, 17, -8.53251770424}, {
     9, 18, -10.9916267505}, {9, 19, -12.5966689229}, {
     9, 20, -12.1649563599}, {9, 21, -11.1342811173}, {
     9, 22, -9.48952739502}, {9, 23, -10.5054998126}, {
     10, 12, 2.03363092441}, {10, 13, -1.26345068831}, {
     10, 14, -1.91208493622}, {10, 15, -3.45461621877}, {
     10, 16, -4.80074477245}, {10, 17, -7.67112192959}, {
     10, 18, -10.6537599323}, {10, 19, -10.0363289369}, {
     10, 20, -13.5642308123}, {10, 21, -13.562451834}, {
     10, 22, -9.09229731847}, {10, 23, -9.52167214425}, {
     11, 12, 2.18369264095}, {11, 13, -1.86743136355}, {
     11, 14, -0.936000582472}, {11, 15, -1.85009848552}, {
     11, 16, -5.14788484512}, {11, 17, -7.62986406043}, {
     11, 18, -9.38319796517}, {11, 19, -12.0567486838}, {
     11, 20, -13.5944161606}, {11, 21, -14.1679142399}, {
     11, 22, -10.6509330414}, {11, 23, -6.89786133293}, {
     12, 12, -1.5338413225}, {12, 13, -2.623667731}, {
     12, 14, -3.8801795077}, {12, 15, -2.86201531509}, {
     12, 16, -4.16201028616}, {12, 17, -5.78358887936}, {
     12, 18, -9.76135095868}, {12, 19, -11.1699540834}, {
     12, 20, -14.3026536187}, {12, 21, -9.3912642755}, {
     12, 22, -7.11518053008}, {12, 23, -6.60369508366}, {
     12, 24, -3.94341460217}, {12, 25, -1.24224050599}, {
     12, 26, -3.62143298805}, {12, 27, 0.604403134626}, {
     12, 28, 4.85459962222}, {12, 29, 5.38882217835}, {
     13, 12, -2.68320377884}, {13, 13, -5.12428714386}, {
     13, 14, -6.02764527208}, {13, 15, -7.41782967781}, {
     13, 16, -4.94717505062}, {13, 17, -6.77031285857}, {
     13, 18, -7.92873386303}, {13, 19, -9.80269724115}, {
     13, 20, -12.2576044729}, {13, 21, -8.58156449066}, {
     13, 22, -5.26685338162}, {13, 23, -4.48316803257}, {
     13, 24, -3.93822621448}, {13, 25, 1.11161070796}, {
     13, 26, -2.79714109949}, {13, 27, 0.27503858863}, {
     13, 28, 2.62620984357}, {13, 29, 3.32932638353}, {
     14, 12, -6.5271493003}, {14, 13, -3.18222123355}, {
     14, 14, -5.84893531094}, {14, 15, -5.32530263745}, {
     14, 16, -5.15070967299}, {14, 17, -7.10816345088}, {
     14, 18, -11.2012250923}, {14, 19, -10.2639322122}, {
     14, 20, -8.70975324643}, {14, 21, -9.34109753638}, {
     14, 22, -7.77748994732}, {14, 23, -4.79200662832}, {
     14, 24, -3.15104121025}, {14, 25, -1.43085793978}, {
     14, 26, -0.63767913396}, {14, 27, 0.642442093736}, {
     14, 28, 0.713973990239}, {14, 29, 2.44205173225}, {
     15, 12, -3.13339415369}, {15, 13, -1.38987559547}, {
     15, 14, -4.17335038371}, {15, 15, -4.69223849858}, {
     15, 16, -6.09039436447}, {15, 17, -5.79905895654}, {
     15, 18, -7.45286990658}, {15, 19, -9.23285559261}, {
     15, 20, -10.3251841119}, {15, 21, -6.16877811238}, {
     15, 22, -5.09103215444}, {15, 23, -2.89069176034}, {
     15, 24, -2.62147940124}, {15, 25, -0.791159582823}, {
     15, 26, 2.51919131239}, {15, 27, 1.86303790204}, {
     15, 28, -0.296886309817}, {15, 29, 0.868953848117}, {
     16, 12, -4.36767019581}, {16, 13, -1.18034805536}, {
     16, 14, -3.80609920049}, {16, 15, -3.55683693044}, {
     16, 16, -3.33727095845}, {16, 17, -1.22797369511}, {
     16, 18, -3.49339599323}, {16, 19, -7.62261714755}, {
     16, 20, -8.84402229737}, {16, 21, -7.04333839373}, {
     16, 22, -5.27654344893}, {16, 23, -3.40455443573}, {
     16, 24, -2.30984163703}, {16, 25, -1.11203603153}, {
     16, 26, -0.638452226939}, {16, 27, 1.53463054919}, {
     16, 28, 0.968548988268}, {16, 29, 0.549389320435}, {
     17, 12, -3.05523924854}, {17, 13, -1.91738056377}, {
     17, 14, -0.0716654141626}, {17, 15, 0.323138303284}, {
     17, 16, 2.19674730894}, {17, 17, 1.44425986502}, {
     17, 18, -2.06994817772}, {17, 19, -4.53578598019}, {
     17, 20, -6.64976946176}, {17, 21, -7.46181690724}, {
     17, 22, -4.3599541596}, {17, 23, -3.85282170487}, {
     17, 24, -2.79866109206}, {17, 25, -3.38406721299}, {
     17, 26, -1.59707340878}, {17, 27, 0.605132830138}, {
     17, 28, 0.159507193857}, {17, 29, 4.17163298906}, {
     18, 6, -2.70674610725}, {18, 7, -7.31714325929}, {
     18, 8, -8.13210776063}, {18, 9, -7.90492846337}, {
     18, 10, -7.45653984998}, {18, 11, -6.1272329668}, {
     18, 12, -0.824414016252}, {18, 13, -0.0873520225093}, {
     18, 14, 0.391668249029}, {18, 15, 6.15564691122}, {
     18, 16, 5.95536279219}, {18, 17, 5.35953517109}, {
     18, 18, 1.47343336665}, {18, 19, -1.88538234394}, {
     18, 20, -10.3507198357}, {18, 21, -6.47329215595}, {
     18, 22, -3.14382749931}, {18, 23, -4.45848258738}, {
     18, 24, -3.56025926312}, {18, 25, -1.56952112103}, {
     18, 26, -1.75607561232}, {18, 27, -2.84314591797}, {
     18, 28, -0.584808170766}, {18, 29, 4.43581674963}, {
     19, 6, -4.12569284957}, {19, 7, -6.17089197603}, {
     19, 8, -7.26738684089}, {19, 9, -8.48756082723}, {
     19, 10, -8.4384448016}, {19, 11, -8.47938616047}, {
     19, 12, -3.27003005426}, {19, 13, -0.477021006266}, {
     19, 14, 3.46893765052}, {19, 15, 4.68839187007}, {
     19, 16, 9.94104363143}, {19, 17, 8.41276164571}, {
     19, 18, 2.17914041879}, {19, 19, -1.04978344634}, {
     19, 20, -3.38757456022}, {19, 21, -6.55987705969}, {
     19, 22, -5.09194458185}, {19, 23, -3.34061403602}, {
     19, 24, -2.90401968824}, {19, 25, -3.16330658074}, {
     19, 26, -0.101124789839}, {19, 27, -0.612012431408}, {
     19, 28, 0.994862147302}, {19, 29, 0.696027723489}, {
     20, 6, -6.94124829203}, {20, 7, -6.02864789761}, {
     20, 8, -6.81834157464}, {20, 9, -11.9975683147}, {
     20, 10, -8.83232221741}, {20, 11, -8.42255699624}, {
     20, 12, -5.17135447025}, {20, 13, -2.66750547226}, {
     20, 14, -3.24492515815}, {20, 15, 1.89685786592}, {
     20, 16, 5.24415640459}, {20, 17, 6.75270158991}, {
     20, 18, 0.697395285438}, {20, 19, -2.86544903999}, {
     20, 20, -3.09183277135}, {20, 21, -4.91435258187}, {
     20, 22, -5.26129969672}, {20, 23, -5.5428953455}, {
     20, 24, -2.78377505906}, {20, 25, -2.43473511616}, {
     20, 26, -2.65823189561}, {20, 27, -1.64643586606}, {
     20, 28, 1.36302027482}, {20, 29, 1.99584343469}, {
     21, 6, -3.50449843503}, {21, 7, -7.82832966677}, {
     21, 8, -8.41250593846}, {21, 9, -9.30862009957}, {
     21, 10, -8.89239413447}, {21, 11, -8.13119625343}, {
     21, 12, -5.35542016481}, {21, 13, -3.29260551382}, {
     21, 14, -4.40541073109}, {21, 15, -1.82630762281}, {
     21, 16, -1.19850699477}, {21, 17, -1.15549821665}, {
     21, 18, -4.15796434038}, {21, 19, -7.81667545831}, {
     21, 20, -7.29580662562}, {21, 21, -3.98154195283}, {
     21, 22, -5.32640142549}, {21, 23, -2.88643918901}, {
     21, 24, -1.28876349517}, {21, 25, 0.495323792069}, {
     21, 26, 1.92843008404}, {21, 27, 3.37031757999}, {
     21, 28, 2.20909728345}, {21, 29, 3.03962214126}, {
     22, 6, -3.11036472192}, {22, 7, -4.43118817479}, {
     22, 8, -7.67139049505}, {22, 9, -6.39294411845}, {
     22, 10, -5.2960137462}, {22, 11, -8.05282518876}, {
     22, 12, -7.17651997171}, {22, 13, -5.23757688134}, {
     22, 14, -4.36871830788}, {22, 15, -6.57260756339}, {
     22, 16, -9.0889127934}, {22, 17, -9.60423423165}, {
     22, 18, -11.1172597662}, {22, 19, -11.0563520839}, {
     22, 20, -7.60720490862}, {22, 21, -4.98702500487}, {
     22, 22, -3.06743666852}, {22, 23, -2.76536485355}, {
     22, 24, -3.65033875706}, {22, 25, -3.13340626282}, {
     22, 26, -0.52758695495}, {22, 27, 0.193412927116}, {
     22, 28, 2.67331628429}, {22, 29, 5.66288783678}, {
     23, 6, 2.52335219257}, {23, 7, 0.77397180619}, {23, 8, -3.61017527317}, {
     23, 9, -2.80882411521}, {23, 10, -4.07454485522}, {
     23, 11, -8.53353709016}, {23, 12, -10.2503315833}, {
     23, 13, -6.34993237739}, {23, 14, -8.97868716769}, {
     23, 15, -9.34379285051}, {23, 16, -13.4203312258}, {
     23, 17, -14.5433714876}, {23, 18, -13.3221092408}, {
     23, 19, -15.3042028476}, {23, 20, -9.88052276799}, {
     23, 21, -6.64537547427}, {23, 22, -7.9312207468}, {
     23, 23, -5.58797019069}, {23, 24, -6.86221004027}, {
     23, 25, -5.45351354147}, {23, 26, -2.7505863716}, {
     23, 27, -0.867631312652}, {23, 28, 1.78035363447}, {
     23, 29, 5.37112174076}, {24, 6, 5.06258743717}, {24, 7, 3.03868703282}, {
     24, 8, -3.2590825535}, {24, 9, -3.57242788738}, {
     24, 10, -2.25919564009}, {24, 11, -7.58456188298}, {
     24, 12, -8.77928906693}, {24, 13, -11.0234845869}, {
     24, 14, -11.7886229112}, {24, 15, -11.2693933274}, {
     24, 16, -12.7068558272}, {24, 17, -14.3243635994}, {
     24, 18, -14.4489868896}, {24, 19, -12.8218566395}, {
     24, 20, -11.0376528146}, {24, 21, -8.95519452844}, {
     24, 22, -8.88145765815}, {24, 23, -5.11968942146}, {
     24, 24, -10.0846595662}, {24, 25, -9.07607816735}, {
     24, 26, -5.64776266808}, {24, 27, -1.39492232021}, {
     24, 28, 0.84995742866}, {24, 29, 4.25254882047}, {
     25, 6, 0.204852697167}, {25, 7, 1.98271908143}, {
     25, 8, 0.768385027413}, {25, 9, -0.534504090281}, {
     25, 10, -2.09861233244}, {25, 11, -7.05047056394}, {
     25, 12, -9.9161522803}, {25, 13, -11.3550871609}, {
     25, 14, -9.97589482913}, {25, 15, -10.9864912483}, {
     25, 16, -13.9996371281}, {25, 17, -13.0145330437}, {
     25, 18, -16.074879092}, {25, 19, -16.8322805656}, {
     25, 20, -15.1219186611}, {25, 21, -12.0400164989}, {
     25, 22, -9.77548462444}, {25, 23, -7.04732861521}, {
     25, 24, -7.14610357511}, {25, 25, -8.74365884441}, {
     25, 26, -6.0146926732}, {25, 27, -3.74172093011}, {
     25, 28, 0.452122984139}, {25, 29, 2.86662971717}, {
     26, 6, -0.825075829606}, {26, 7, 0.484912928759}, {
     26, 8, -2.15542653703}, {26, 9, -1.74704960593}, {
     26, 10, -4.26404116778}, {26, 11, -4.79251523962}, {
     26, 12, -6.68096066416}, {26, 13, -11.2951137882}, {
     26, 14, -11.7846774898}, {26, 15, -11.3162569669}, {
     26, 16, -13.1049783983}, {26, 17, -16.7508976797}, {
     26, 18, -16.7228392568}, {26, 19, -18.4688827949}, {
     26, 20, -15.2130881368}, {26, 21, -11.934517845}, {
     26, 22, -9.92317116986}, {26, 23, -6.3657259005}, {
     26, 24, -5.88184760256}, {26, 25, -5.64961936064}, {
     26, 26, -3.48280041554}, {26, 27, -0.269002205491}, {
     26, 28, 1.6278307607}, {26, 29, 3.43143602614}, {
     27, 6, -1.09439930405}, {27, 7, -1.68388014239}, {
     27, 8, -1.72672072214}, {27, 9, -1.31136915993}, {
     27, 10, -3.88277683165}, {27, 11, -8.45811181943}, {
     27, 12, -9.04005608024}, {27, 13, -8.7868765161}, {
     27, 14, -10.1891127793}, {27, 15, -11.228460314}, {
     27, 16, -14.4358554172}, {27, 17, -16.9885088083}, {
     27, 18, -18.5172187279}, {27, 19, -16.5641794911}, {
     27, 20, -14.5283623219}, {27, 21, -12.2443921919}, {
     27, 22, -8.90249789259}, {27, 23, -8.03854807419}, {
     27, 24, -6.01258030085}, {27, 25, -2.18228616834}, {
     27, 26, -0.947755588231}, {27, 27, 2.17947774557}, {
     27, 28, 2.52538064067}, {27, 29, 3.06915546766}, {
     28, 6, -3.41433101383}, {28, 7, 1.13442459465}, {
     28, 8, -2.17324809467}, {28, 9, -2.89345094953}, {
     28, 10, -5.1490012665}, {28, 11, -8.3153346147}, {
     28, 12, -9.59233708414}, {28, 13, -7.69301908454}, {
     28, 14, -10.4914340601}, {28, 15, -12.0089921817}, {
     28, 16, -11.7006510292}, {28, 17, -13.6059458506}, {
     28, 18, -15.5074348856}, {28, 19, -14.0499045889}, {
     28, 20, -12.7190173176}, {28, 21, -9.10867745284}, {
     28, 22, -8.1145968379}, {28, 23, -6.40980475964}, {
     28, 24, -5.01258467815}, {28, 25, -2.67821402371}, {
     28, 26, 4.85776722592}, {28, 27, 4.76994046473}, {
     28, 28, 2.4774698092}, {28, 29, 2.05465628186}, {
     29, 6, -0.470834414047}, {29, 7, 0.508062975583}, {
     29, 8, -0.733077026456}, {29, 9, -3.55987289644}, {
     29, 10, -6.06770418384}, {29, 11, -7.13816327872}, {
     29, 12, -5.22198528277}, {29, 13, -5.09451707782}, {
     29, 14, -11.1149811195}, {29, 15, -11.450047182}, {
     29, 16, -10.9777142033}, {29, 17, -13.6513999077}, {
     29, 18, -12.1372036142}, {29, 19, -11.3925942118}, {
     29, 20, -12.2510794482}, {29, 21, -8.75384641671}, {
     29, 22, -5.9685631468}, {29, 23, -5.97666253485}, {
     29, 24, -4.91153802461}, {29, 25, 0.635368031953}, {
     29, 26, 3.45261874332}, {29, 27, 3.56660488433}, {
     29, 28, 1.20682759345}, {29, 29, 4.52790066101}}]},
  Axes->True,
  BoxRatios->{1, 1, 0.4},
  ImageSize->{671., 521.},
  PlotRange->{{6, 29}, {6, 29}, Automatic},
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.02]}, {Automatic, Automatic}},
  ViewPoint->{1.6632072409100138`, -1.2890177028735719`, 2.6499386852270836`},
  
  ViewVertical->{-0.02830287217743213, 0.34248784328110515`, 
   2.3477396371712054`}]], "Output",
 CellChangeTimes->{3.5912869474009733`*^9, 3.591286978420969*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mean", "[", 
  RowBox[{"data", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.591286877605856*^9, 3.591286903275188*^9}}],

Cell[BoxData[
 RowBox[{"-", "4.860499080853714`"}]], "Output",
 CellChangeTimes->{{3.5912868829402533`*^9, 3.591286903566087*^9}}]
}, Open  ]],

Cell[, "Input"],

Cell[CellGroupData[{

Cell[, "Input"],

Cell[, "Output"],

Cell[, "Output"]
}, Open  ]]
},
WindowSize->{1920, 1004},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 723, 12, 50, "Input"],
Cell[1283, 34, 79, 2, 30, "Input"],
Cell[1365, 38, 394, 13, 30, "Input"],
Cell[1762, 53, 752, 24, 30, "Input"],
Cell[2517, 79, 1418, 42, 30, "Input"],
Cell[3938, 123, 2484, 81, 50, "Input"],
Cell[CellGroupData[{
Cell[6447, 208, 150, 3, 30, "Input"],
Cell[6600, 213, 24785, 708, 574, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31422, 926, 29664, 776, 1019, "Input"],
Cell[61089, 1704, 307, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61433, 1714, 116, 2, 30, "Input"],
Cell[61552, 1718, 72, 1, 30, "Output"]
}, Open  ]],
Cell[61639, 1722, 1877, 56, 69, "Input"],
Cell[CellGroupData[{
Cell[63541, 1782, 97, 1, 30, "Input"],
Cell[63641, 1785, 72, 1, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63750, 1791, 1571, 46, 50, "Input"],
Cell[65324, 1839, 356, 9, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65717, 1853, 139, 2, 30, "Input"],
Cell[65859, 1857, 13950, 249, 536, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79846, 2111, 205, 5, 30, "Input"],
Cell[80054, 2118, 130, 2, 30, "Output"]
}, Open  ]],
Cell[80199, 2123, 15, 0, 30, "Input"],
Cell[CellGroupData[{
Cell[80239, 2127, 15, 0, 30, "Input"],
Cell[80257, 2129, 16, 0, 30, "Output"],
Cell[80276, 2131, 16, 0, 30, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
